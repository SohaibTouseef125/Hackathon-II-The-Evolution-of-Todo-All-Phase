# Next.js 16 App Router Patterns

## Route Organization

### Basic Route Structure
```
app/
├── layout.tsx          # Root layout
├── page.tsx            # Homepage
├── about/
│   └── page.tsx        # /about
├── products/
│   ├── page.tsx        # /products
│   ├── layout.tsx      # Products section layout
│   └── [id]/
│       └── page.tsx    # /products/[id]
└── dashboard/
    ├── layout.tsx
    └── page.tsx        # /dashboard
```

### Route Groups
Use parentheses to organize routes without affecting the URL structure:

```
app/
├── (marketing)/        # Marketing section (no URL impact)
│   ├── page.tsx       # /
│   ├── about/
│   │   └── page.tsx   # /about
│   └── layout.tsx
└── (app)/             # App section (no URL impact)
    ├── dashboard/
    │   └── page.tsx   # /dashboard
    └── settings/
        └── page.tsx   # /settings
```

### Parallel Routes
Use slots to render multiple routes at the same level:

```tsx
// layout.tsx
export default function Layout({
  children,
  modal,
}: {
  children: React.ReactNode
  modal: React.ReactNode
}) {
  return (
    <>
      {children}
      {modal && <div className="modal">{modal}</div>}
    </>
  )
}
```

```
app/
├── @modal/
│   └── default.tsx
├── @modal/(.)settings/
│   └── page.tsx
└── page.tsx
```

## Layout Patterns

### Root Layout
```tsx
// app/layout.tsx
import './globals.css'

export const metadata = {
  title: 'My App',
  description: 'Generated by create next app',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

### Nested Layouts
```tsx
// app/dashboard/layout.tsx
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <section>
      <nav>Dashboard Navigation</nav>
      <main>{children}</main>
    </section>
  )
}
```

## Special Files

### Loading UI
```tsx
// app/products/loading.tsx
export default function Loading() {
  return <div>Loading products...</div>
}
```

### Error Boundaries
```tsx
// app/products/error.tsx
'use client'

export default function Error({
  error,
  reset,
}: {
  error: Error
  reset: () => void
}) {
  return (
    <div>
      <p>Something went wrong!</p>
      <button onClick={() => reset()}>Try again</button>
    </div>
  )
}
```

### Not Found Pages
```tsx
// app/not-found.tsx
export default function NotFound() {
  return (
    <div>
      <h2>Not Found</h2>
      <p>Could not find requested resource</p>
    </div>
  )
}
```

## Dynamic Routes

### Single Parameter
```
app/products/[id]/page.tsx
```

```tsx
export default async function ProductPage({
  params,
}: {
  params: { id: string }
}) {
  const product = await getProduct(params.id)

  return <div>{product.name}</div>
}
```

### Catch-all Segments
```
app/blog/[...slug]/page.tsx
```

```tsx
export default async function BlogPost({
  params,
}: {
  params: { slug: string[] }
}) {
  // For /blog/2023/12/01/title -> ['2023', '12', '01', 'title']
  return <div>Blog post: {params.slug.join('/')}</div>
}
```

### Optional Catch-all
```
app/docs/[[...slug]]/page.tsx
```

```tsx
export default async function DocsPage({
  params,
}: {
  params: { slug?: string[] }
}) {
  // Both /docs and /docs/advanced/api are valid
  const path = params.slug?.join('/') || 'index'
  return <div>Documentation: {path}</div>
}
```

## Route Handlers

### Basic API Route
```ts
// app/api/users/route.ts
import { NextRequest } from 'next/server'

export async function GET(request: NextRequest) {
  const users = await getUsers()
  return Response.json(users)
}

export async function POST(request: NextRequest) {
  const data = await request.json()
  const user = await createUser(data)
  return Response.json(user, { status: 201 })
}
```

### Dynamic Route Handler
```ts
// app/api/users/[id]/route.ts
import { NextRequest } from 'next/server'

export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  const user = await getUser(params.id)
  return Response.json(user)
}

export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  const data = await request.json()
  const updatedUser = await updateUser(params.id, data)
  return Response.json(updatedUser)
}
```

## Search Parameters

```tsx
// app/search/page.tsx
import { ProductList } from '@/components/product-list'

export default async function SearchPage({
  searchParams,
}: {
  searchParams: { [key: string]: string | string[] | undefined }
}) {
  const query = searchParams.query || ''
  const category = searchParams.category || 'all'

  return <ProductList query={query} category={category} />
}
```

## Route Groups for Authentication

```
app/
├── (auth)/
│   ├── login/
│   │   └── page.tsx
│   └── signup/
│       └── page.tsx
├── (app)/
│   ├── dashboard/
│   │   └── page.tsx
│   └── profile/
│       └── page.tsx
└── layout.tsx
```

This allows you to have different layouts for authenticated vs public sections while maintaining clean URL structures.